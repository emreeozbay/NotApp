@model NotApp.Controllers.NotesIndexVM
@{
    ViewData["Title"] = "Notlar";
}

<!-- Arama + Filtre -->
<div class="mb-3">
    <form method="get" class="search-wrap">
        <span class="icon">🔎</span>
        <input class="search-input" name="q" placeholder="Not ara..." value="@Model.Q" />

        <select class="dark-select" name="faculty">
            <option value="">Fakülte Seç</option>
            @foreach (var f in Model.Faculties)
            {
                if (Model.Faculty == f) { <option value="@f" selected>@f</option>; }
                else { <option value="@f">@f</option>; }
            }
        </select>

        <select class="dark-select" name="classLevel">
            <option value="">Sınıf Seç</option>
            @foreach (var c in Model.ClassLevels)
            {
                if (Model.ClassLevel == c) { <option value="@c" selected>@c</option>; }
                else { <option value="@c">@c</option>; }
            }
        </select>

        <button class="btn btn-primary ms-2">Filtrele</button>
    </form>
</div>

<!-- Liste -->
@if (!Model.Items.Any())
{
    <div class="note-card">
        <div class="meta">Kriterlere uygun not bulunamadı.</div>
    </div>
}
else
{
    foreach (var n in Model.Items)
    {
        <div class="note-card">
            <div class="d-flex justify-content-between align-items-start">
                <div>
                    <div class="note-title">@n.StudentDisplayName</div>
                    @if (!string.IsNullOrWhiteSpace(n.Description))
                    {
                        <div class="meta">@n.Description</div>
                    }
                    <div class="meta mt-2">
                        🏛️ <strong>Fakülte:</strong> @n.Faculty<br />
                        🏫 <strong>Bölüm:</strong> @n.Department<br />
                        🎓 <strong>Sınıf:</strong> @n.ClassLevel<br />
                        📘 <strong>Ders:</strong> @n.CourseName<br />
                        📂 <strong>Belge Türü:</strong> @n.DocumentType
                    </div>
                </div>

                <div class="mt-2">
                    @if (!string.IsNullOrWhiteSpace(n.FileUrl))
                    {
                        <a class="btn-accent" href="@n.FileUrl" target="_blank" rel="noopener">Görüntüle</a>
                    }
                    else
                    {
                        <button class="btn-accent" disabled>Görüntüle</button>
                    }
                </div>
            </div>
        </div>
    }
}
